"use strict";function setSize(n){var t=window.getComputedStyle(n).backgroundSize.split(" "),o={};return 1===t.length?(o.width=parseInt(t[0]),o.height=parseInt(t[0])):(o.width=parseInt(t[0]),o.height=parseInt(t[1])),o}function setGo(){var n=window.decodeURI(window.location.search.substr(1)).split("&"),a={};return n.forEach(function(n,t){var o=n.split("=");a[o[0]]=o[1]}),a}$.ajax({url:"../server/goods_detail.php",data:{goods_id:setGo().goods_id},type:"post",dataType:"json",success:function(e){var n;console.log(e),n='\n            \n            <div class="show">\n                <img src=\''.concat(e.goods_big_logo,'\' alt="">\n                <div class="mack"></div>\n            </div>\n\n        <div class="glass"></div>\n\n            \n        <div class="content">\n            <h1>').concat(e.goods_name,"</h1>\n            <p>").concat(e.cat_id,'</p>\n            <p class="Q">价格<span>￥').concat(e.goods_price,'</span></p>\n            <p class="yf">运费<span>XXX</span></p>\n            <div class="pj">\n                <ul>\n                    <li>累计评价XX</li>\n                    <li>XXXXX</li>\n                </ul>\n            </div>\n            <p class="number">数量\n                <input type="text" value=1 disabled>\n                <button name="jian">-</button>\n                <button name="jia">+</button>\n            </p>\n            <button class="jrCart">加入购物车</button>\n        </div>\n            \n            \n            '),$(".box").html(n),$(".glass").css({backgroundImage:"url(".concat(e.goods_big_logo,")")}),$(".show").mouseenter(function(){$(".mack").css({display:"block"}),$(".glass").css({display:"block"})}),$(".show").mouseleave(function(){$(".mack").css({display:"none"}),$(".glass").css({display:"none"})}),$(".show").mousemove(function(n){var t=n.pageX-parseInt($(".box").css("marginLeft"))-parseInt($(".show").css("borderWidth"))-$(".mack").outerWidth()/2,o=n.pageY-parseInt($(".box").css("marginTop"))-parseInt($(".show").css("borderWidth"))-$(".mack").outerHeight();t<0&&(t=0),o<0&&(o=0),t>$(".show").innerWidth()-$(".mack").outerWidth()&&(t=$(".show").innerWidth()-$(".mack").outerWidth()),o>$(".show").innerHeight()-$(".mack").outerHeight()&&(o=$(".show").innerHeight()-$(".mack").outerHeight());var a=setSize($(".glass")[0]).width*t/$(".show").innerWidth(),s=setSize($(".glass")[0]).height*o/$(".show").innerHeight();$(".glass").css({backgroundPosition:"-".concat(a,"px -").concat(s,"px")}),$(".mack").css({left:t+"px",top:o+"px"})}),$('[name="jian"]').click(function(){if($(".number>input").attr("value")-0!=1){var n=$(".number>input").attr("value")-0;n--,$(".number>input").attr({value:n})}}),$('[name="jia"]').click(function(){var n=$(".number>input").attr("value")-0;++n>e.goods_number||$(".number>input").attr({value:n})}),$(".jrCart").click(function(){var n,a;if(void 0===(n=document.cookie.split("; "),a={},n.forEach(function(n,t){var o=n.split("=");a[o[0]]=o[1]}),a).index)window.confirm("您还没有登录,点击确定前往登录页面")&&(window.location.href="../pages/login.html?url=".concat(window.location.href));else if(null===window.localStorage.getItem("cart")){e.num=$(".number>input").attr("value")-0,e.buy=!0;var t=[e];console.log(t),window.localStorage.setItem("cart",JSON.stringify(t)),window.open("./cart.html")}else{var o=JSON.parse(window.localStorage.getItem("cart")),s=!0;o.forEach(function(n,t){e.goods_id===n.goods_id&&(n.num+=$(".number>input").attr("value")-0,s=!1)}),s&&(e.num=$(".number>input").attr("value")-0,e.buy=!0,o.push(e)),window.localStorage.setItem("cart",JSON.stringify(o)),window.open("./cart.html")}})}});